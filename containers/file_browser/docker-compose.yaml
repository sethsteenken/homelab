version: "3.6"
services:
  file_browser:
    cap_drop:
      - "AUDIT_CONTROL"
      - "BLOCK_SUSPEND"
      - "DAC_READ_SEARCH"
      - "IPC_LOCK"
      - "IPC_OWNER"
      - "LEASE"
      - "LINUX_IMMUTABLE"
      - "MAC_ADMIN"
      - "MAC_OVERRIDE"
      - "NET_ADMIN"
      - "NET_BROADCAST"
      - "SYSLOG"
      - "SYS_ADMIN"
      - "SYS_BOOT"
      - "SYS_MODULE"
      - "SYS_NICE"
      - "SYS_PACCT"
      - "SYS_PTRACE"
      - "SYS_RAWIO"
      - "SYS_RESOURCE"
      - "SYS_TIME"
      - "SYS_TTY_CONFIG"
      - "WAKE_ALARM"
    container_name: "file_browser"
    image: hurlenko/filebrowser
    user: "${UID}:${GID}"
    network_mode: "bridge"
    ports:
      - ${ACCESS_PORT}:8080/tcp
    volumes:
      - nas_media:/data/media
      - nas_documents:/data/documents
      - nas_backups:/data/backups
      - nas_software:/data/software
      - /var/lib/docker/volumes:/data/docker/volumes
      - file_browser_data:/config
    environment:
      - FB_BASEURL=/filebrowser
    restart: always
    healthcheck:
      test: "wget --no-verbose --tries=1 --spider http://localhost:8080 || exit 1"
      interval: 60s
      timeout: 5s
      retries: 3
      start_period: 10s
volumes:
  nas_media:
    external: true
  nas_documents:
    external: true
  nas_backups:
    external: true
  nas_software:
    external: true
  file_browser_data:
    external: true